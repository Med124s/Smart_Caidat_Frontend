<div class="mb-4 flex justify-between">
  <div class="inline-block">
    <h3 class="text-foreground font-semibold">Membres</h3>
    <div class="text-muted-foreground space-x-1 text-xs font-medium">
      <span>Tous les utilisateurs:</span>
      <span class="text-foreground">{{ totalItems() }}</span>
    </div>
  </div>

  <div class="inline-block space-x-4">
    <button
      (click)="showCreateModal()"
      class="bg-primary text-primary-foreground flex-none rounded-md px-4 py-2.5 text-xs font-semibold">
      Ajouter utilisateur
    </button>

    <app-user
      [hidden]="!showModal"
      [user]="selectedUser()"
      [mode]="modalMode"
      (save)="saveUser($event)"
      (close)="showModal = false">
    </app-user>
  </div>
</div>

<div class="border-muted/20 bg-background flex min-w-full flex-col rounded-xl border p-2">
  <!-- <app-table-action
    [usersResults]="filteredUsers"
    [updateUsersResults]="updateUsersResults">
    
  </app-table-action> -->
  <app-table-action
    [selectedIds]="selectedIds()"
    [selectedUser]="selectedUsers"
    (filter)="onFilter($event)"
    (deleteSelected)="onDeleteSelected($event)"
    [totalItems] = "totalItems()"
    [size] = "this.searchPage.size"
    
    >
  </app-table-action>

  <div
    class="scrollbar-thumb-rounded scrollbar-track-rounded scrollbar-thin scrollbar-track-transparent scrollbar-thumb-muted grow overflow-x-auto px-5">
    <table
      class="text-muted-foreground table w-full table-auto border-collapse border-0 text-left align-middle leading-5">
      <thead class="border-muted/20 text-muted-foreground border text-xs">
        <!-- <tr
          app-table-header
          [userIds]="visibleUserIds()"
          (onCheck)="toggleUsers($event)">
        </tr> -->
        <tr app-table-header [userIds]="visibleUserIds()"></tr>
      </thead>

      <tbody>
        @for (user of visibleUsers() || []; track $index) {
        <tr
          class="hover:bg-card/50"
          app-table-row
          [user]="user"
          (onDeleteSelected)="onDeleteSelected($event)"
          (detailUser)="detailUser($event)"
          (onUpdateUser)="onUpdateUser($event)"></tr>
        } @empty {

        <tr>
          <td class="py-4 text-center text-sm" colspan="7">Aucun utilisateur trouv√©</td>
        </tr>

        }
      </tbody>
    </table>

    <div *ngIf="loadingSearch()" class="py-4 text-center">
      <div class="inline-flex items-center gap-2">
        <div class="h-5 w-5 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"></div>
        <span class="text-gray-600">Chargement...</span>
      </div>
    </div>
  </div>

  <app-table-footer
    [currentPage]="searchPage.page"
    [totalPages]="totalPages()"
    [totalItems]="totalItems()"
    [size]="searchPage.size"
    (pageChange)="onPageChange($event)"
    (sizeChange)="onSizeChange($event)">
  </app-table-footer>
</div>
